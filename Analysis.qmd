---
title: "Power-Shifts"
author: "Pranjal Tariga Suresh & Shashank Jayakumar"
format: pdf
editor: visual
---

```{r}
#| label: setup
#| include: false

# Set global knitr options
knitr::opts_chunk$set(
  echo = TRUE, 
  message = FALSE, 
  warning = FALSE
)

# Loading the libraries
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)

energy <- read_csv("data.csv")
```

# 1.Data overview

```{r}
dim(energy) # Dimensions 
```

```{r}
dplyr::summarise(
  energy,
  n_countries = dplyr::n_distinct(Country),
  n_regions   = dplyr::n_distinct(Region),
  n_types     = dplyr::n_distinct(Type),
  year_min    = min(Year, na.rm = TRUE),
  year_max    = max(Year, na.rm = TRUE)
)
```

```{r}
energy_clean <- energy %>%
  dplyr::rename(energy_ej = `Energy consumption (in Exajoules)`)

names(energy_clean)
```
```{r}
dplyr::count(energy_clean, Type, sort = TRUE)
```

# 2.Checking missing values

```{r}
sum(is.na(energy_clean)) # total NAs in the entire data frame
```

```{r}

colSums(is.na(energy_clean)) # NAs by column (counts)
```

```{r}
range(energy_clean$Year, na.rm = TRUE)
```

``` r
# If we had NAs in the dataset we could have use this code chunk to get rid of NAs
energy_clean <- energy_clean %>%
  filter(!is.na(Year), !is.na(Type), !is.na(energy_ej))
```

```{r}
#| label: summarize-year-type

energy_summary <- energy_clean %>%
  dplyr::group_by(Year, Type) %>%
  dplyr::summarize(
    total = sum(energy_ej, na.rm = TRUE),
    .groups = "drop"
  )

dplyr::slice_head(energy_summary, n = 10)

```

# VIZ-1

```{r}
#| label: viz-total-energy-bars-yearly

energy_total <- energy_clean %>%
  dplyr::group_by(Year) %>%
  dplyr::summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups = "drop")

ggplot(energy_total, aes(x = factor(Year), y = total_ej)) +
  geom_col() +
  labs(
    title = "Global Energy Consumption by Year (1965‚Äì2021)",
    x = "Year",
    y = "Energy (EJ)"
  ) +
  theme_minimal() +
  # show every 5th year label so it‚Äôs readable
  scale_x_discrete(breaks = as.character(seq(min(energy_total$Year), max(energy_total$Year), by = 5))) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```
**Fig.1** This bar chart shows that global energy consumption has more than tripled between 1965 and 2021. I noticed a slowdown in the late 1970s and early 1980s, which I found was linked to the global oil crisis, before growth picked up again. After 2000, consumption rises even faster. Overall, the chart makes it clear how energy demand keeps increasing despite short-term shocks.

# VIZ-2

```{r}

# Summarize total consumption by energy type
energy_type_total <- energy_clean %>%
  group_by(Type) %>%
  summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups = "drop") %>%
  arrange(desc(total_ej))

# Horizontal bar plot
ggplot(energy_type_total, aes(x = reorder(Type, total_ej), y = total_ej, fill = Type)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(
    title = "Total Global Energy Consumption by Type (1965‚Äì2021)",
    x = "Energy Type",
    y = "Total Energy Consumption (EJ)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.y = element_text(face = "bold")
  )

```
**Figure 2** shows how different types of energy have contributed to global use between 1965 and 2021. Oil clearly leads overall, with coal and natural gas not far behind. Together, these fossil fuels make up most of the world‚Äôs energy supply. Hydro and nuclear have stayed fairly steady through the years, while newer renewables like wind, solar, and biofuels are still small but growing fast.

Renewables were meant to be the safer alternative for a cleaner planet, yet the world still relies on fossil fuels as its main source of energy.

#VIZ-3

```{r}

ggplot(energy_top10_trend, aes(x = Year, y = total_ej, color = Country)) +
  geom_line(linewidth = 1) +
  # X-axis: every 5 years
  scale_x_continuous(
    breaks = seq(min(energy_top10_trend$Year),
                 max(energy_top10_trend$Year), by = 5),
    expand = c(0.01, 0.01)
  ) +
  # Y-axis: show ticks every 10 units instead of 5
  scale_y_continuous(
    breaks = seq(0, 160, by = 15),    # üëà wider spacing, no overlap
    limits = c(0, 160)
  ) +
  labs(
    title = "Energy Consumption Trends of Top 10 Countries (1965‚Äì2021)",
    x = "Year",
    y = "Energy Consumption (EJ)",
    color = "Country"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title      = element_text(face = "bold", hjust = 0.5, size = 15),
    axis.text.x     = element_text(angle = 45, hjust = 1),
    axis.text.y     = element_text(size = 10),
    legend.position = "bottom",
    legend.title    = element_text(face = "bold"),
    panel.grid.minor = element_blank(),   # remove minor grid clutter
    panel.grid.major.y = element_line(linewidth = 0.3, color = "gray80")
  )


```
**Figure 3** shows how energy consumption patterns have evolved for the top ten countries from 1965 to 2021. The United States led global energy use for decades, but China‚Äôs rapid rise after 2000 reflects its industrial expansion and eventually pushes it past the U.S. India‚Äôs growth is steady but much lower in scale, while Japan, Germany, France, and the U.K. have largely stabilized as their economies matured and energy efficiency improved. The CIS region‚Äôs trend dips sharply in the early 1990s because of the breakup of the USSR and its economic slowdown. Canada maintains moderate, stable consumption, and most European nations show only gradual change. Together, the lines reveal a clear shift in global demand‚Äîfrom long-established Western economies toward fast-growing Asian nations‚Äîcapturing the ongoing ‚Äúpower shift‚Äù in world energy use.
#VIZ-4

```{r}

# Summarize total energy by Region and Year
energy_region <- energy_clean %>%
  group_by(Region, Year) %>%
  summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups = "drop")

# Scatter + smooth plot faceted by Region
ggplot(energy_region, aes(x = Year, y = total_ej)) +
  geom_point(color = "black", size = 1) +        # black points
  geom_smooth(color = "blue", se = FALSE, size = 0.6) +  # thinner blue line
  facet_wrap(~ Region, nrow = 2) +
  labs(
    title = "Energy Consumption Trends by Region (1965‚Äì2021)",
    x = "Year",
    y = "Energy Consumption (EJ)"
  ) +
  theme_minimal() +
  theme(
    plot.title  = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    strip.text  = element_text(face = "bold")
  )

```
**Figure 4** displays regional energy consumption trends from 1965 to 2021, combining yearly data points with smoothed trend lines for clarity. The Asia-Pacific region shows the steepest and most consistent growth, overtaking North America and Europe after 2000 as industrial activity and population expanded rapidly. North America and Europe both level off after the late 1990s, reflecting mature economies and efficiency improvements. The Middle East rises steadily, fueled by oil production and domestic demand, while Africa and South & Central America show gradual but persistent increases from lower baselines. The CIS region dips sharply in the early 1990s due to the post-Soviet economic collapse, then stabilizes in later years. Overall, the figure highlights clear geographic contrasts‚Äîrapid acceleration in developing regions alongside slower, stabilized consumption in industrialized economies‚Äîcapturing the global shift in energy demand patterns.

#VIZ-5


```{r}
energy_change <- energy_clean %>%
  group_by(Year) %>%
  summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups="drop") %>%
  arrange(Year) %>%
  mutate(pct_change = (total_ej - lag(total_ej)) / lag(total_ej) * 100)

ggplot(energy_change, aes(x = Year, y = pct_change)) +
  geom_col(fill = "steelblue") +
  geom_hline(yintercept = 0, color="gray40") +
  labs(title = "Year-to-Year % Change in Global Energy Consumption",
       x = "Year", y = "Percent Change") +
  theme_minimal() +
  theme(plot.title = element_text(face="bold", hjust=0.5))

```
**Figure 5** shows the year-to-year percentage change in global energy consumption from 1965 to 2021. The bars highlight periods of both rapid growth and slowdown. The sharp declines in the mid-1970s and early 1980s correspond to the global oil crises, when fuel shortages and economic recessions temporarily reduced demand. After the mid-1980s, fluctuations become smaller, reflecting steadier but slower growth. Another noticeable dip occurs around 2009 during the global financial crisis, and the deepest drop appears in 2020 as the COVID-19 pandemic sharply reduced energy use worldwide. The quick rebound in 2021 indicates how energy demand recovered almost immediately once restrictions eased. Overall, the plot captures how short-term global events‚Äîeconomic shocks, policy changes, and crises‚Äîaffect the long-term upward trend in energy demand.

# VIZ-6

```{r}
renew_types <- c("Solar","Wind","Hydro-electric","Biofuel","Other renewables")

energy_region_share <- energy_clean %>%
  mutate(Category = ifelse(Type %in% renew_types, "Renewable", "Non-Renewable")) %>%
  group_by(Region, Year, Category) %>%
  summarize(total = sum(energy_ej, na.rm = TRUE), .groups = "drop") %>%
  group_by(Region, Year) %>%
  mutate(share = total / sum(total))

ggplot(energy_region_share, aes(x = Year, y = share, fill = Category)) +
  geom_col(position = "fill") +
  facet_wrap(~ Region, nrow = 2) +
  scale_x_continuous(
    breaks = seq(1965, 2021, by = 15),   # üëà Year ticks every 10 years
    expand = c(0, 0)
  ) +
  labs(
    title = "Renewable vs Non-Renewable Energy Share by Region (1965‚Äì2021)",
    x = "Year",
    y = "Share of Total Energy",
    fill = "Category"
  ) +
  scale_y_continuous(labels = scales::percent) +  # optional: make y-axis percent
  theme_minimal() +
  theme(
    plot.title  = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    strip.text  = element_text(face = "bold")
  )

```
**Figure 6** compares renewable and non-renewable energy shares across regions from 1965 to 2021. In every region, non-renewable sources like oil, coal, and natural gas dominate the energy mix, though the share of renewables has slowly increased over time. The Asia-Pacific region, which drives most global demand, shows a noticeable but still modest rise in renewables after 2000, mainly due to expanding hydro and solar power. Europe shows the clearest shift toward renewables, reflecting stronger policy and investment in clean energy. In contrast, North America, the Middle East, and the CIS remain heavily dependent on fossil fuels. South & Central America is the only region where renewables‚Äîmainly hydro‚Äîform a substantial portion of total energy use. Overall, the figure highlights how the global energy transition remains uneven, with only gradual progress toward renewables despite decades of awareness and technological advancement.






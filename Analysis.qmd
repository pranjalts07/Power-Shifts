---
title: "Power-Shifts"
author: "Pranjal Tariga Suresh & Shashank Jayakumar"
format: pdf
editor: visual
---

```{r}
#| label: setup
#| include: false

# Set global knitr options
knitr::opts_chunk$set(
  echo = TRUE, 
  message = FALSE, 
  warning = FALSE
)

# Loading the libraries
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)

energy <- read_csv("data.csv")
```

# 1.Data overview

```{r}
dim(energy) # Dimensions 
```

```{r}
dplyr::summarise(
  energy,
  n_countries = dplyr::n_distinct(Country),
  n_regions   = dplyr::n_distinct(Region),
  n_types     = dplyr::n_distinct(Type),
  year_min    = min(Year, na.rm = TRUE),
  year_max    = max(Year, na.rm = TRUE)
)
```

```{r}
energy_clean <- energy %>%
  dplyr::rename(energy_ej = `Energy consumption (in Exajoules)`)

names(energy_clean)
```

```{r}
glimpse(energy_clean)
```

```{r}
dplyr::count(energy_clean, Type, sort = TRUE)
```

# 2.Checking missing values

```{r}
sum(is.na(energy_clean)) # total NAs in the entire data frame
```

```{r}

colSums(is.na(energy_clean)) # NAs by column 
```

```{r}
range(energy_clean$Year, na.rm = TRUE)
```

``` r
# If we had NAs in the dataset we could have use this code chunk to get rid of NAs
energy_clean <- energy_clean %>%
  filter(!is.na(Year), !is.na(Type), !is.na(energy_ej))
```

```{r}
energy_summary <- energy_clean %>%
  dplyr::group_by(Year, Type) %>%
  dplyr::summarize(
    total = sum(energy_ej, na.rm = TRUE),
    .groups = "drop"
  )

dplyr::slice_head(energy_summary, n = 10)

```

# Visualisation

## 1. Global Trend in Energy Consumption

```{r}

energy_clean |> 
  group_by(Year) |> 
  summarise(global_consumption = sum(energy_ej, na.rm = TRUE)) |> 
  ggplot(aes(x = Year, y = global_consumption)) +
  geom_line(color = "steelblue", linewidth = 1) +
  geom_point(color = "darkblue") +
  labs(
    title = "Fig.1:Global Energy Consumption Over Time",
    x = "Year",
    y = "Total Energy Consumption (Exajoules)"
  ) +
  scale_x_continuous(breaks = seq(1965, 2021, by = 5)) +
  theme_bw()

```

From **Figure 1**, it is clear that energy use in the world has gone up a lot over the past 60 years. It is now almost three times more than before. We also noticed some small dips in the graph, so we did a bit of research to find out what caused them, Between 1975 and 1983, there was an *oil crisis* followed by big changes in oil prices and an economic slowdown, which caused global energy use to fall slightly for a few years. Around 2008, the *global financial crisis* led to less production and trade, so energy use dropped for a short time. In 2020, the *COVID-19 pandemic* caused lockdowns everywhere, and travel and factories almost stopped, leading to a big drop in energy consumption.

## 2. Energy Consumption Trends of Top 10 Countries

```{r}
energy_country_year <- energy_clean %>%
  group_by(Country, Year) %>%
  summarise(total_ej = sum(energy_ej, na.rm = TRUE),
            .groups = "drop")
```

```{r}
top10_countries <- energy_country_year %>%
  group_by(Country) %>%
  summarise(total_all_years = sum(total_ej, na.rm = TRUE),
            .groups = "drop") %>%
  arrange(desc(total_all_years)) %>%
  slice_head(n = 10) %>%
  pull(Country)

top10_countries

```

```{r}
energy_top10_trend <- energy_country_year %>%
  filter(Country %in% top10_countries)

head(energy_top10_trend)

```

```{r}
ggplot(energy_top10_trend, aes(x = Year, y = total_ej, color = Country)) +
  geom_line() +
  scale_x_continuous(
    breaks = seq(min(energy_top10_trend$Year), 
                 max(energy_top10_trend$Year), 
                 by = 5)
  ) +
  labs(
    title = "Fig 2:Energy Consumption Trends of Top 10 Countries (1965–2021)",
    x = "Year",
    y = "Energy Consumption (EJ)",
    color = "Country"
  ) +
  theme_minimal()
```

**Figure 2** shows how energy consumption patterns have evolved for the top ten countries from 1965 to 2021. The United States led global energy use for decades, but China’s rapid rise after 2000 reflects its industrial expansion and eventually pushes it past the U.S. India’s growth is steady but much lower in scale, while Japan, Germany, France, and the U.K. have largely stabilized as their economies matured and energy efficiency improved. The CIS region’s trend dips sharply in the early 1990s because of the breakup of the USSR and its economic slowdown. Canada maintains moderate, stable consumption, and most European nations show only gradual change. Together, the lines reveal a clear shift in global demand—from long-established Western economies toward fast-growing Asian nations—capturing the ongoing “power shift” in world energy use.

## 3. Global Energy Consumption by Type

```{r}
energy_type_total <- energy_clean %>%
  group_by(Type) %>%
  summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups = "drop") %>%
  arrange(desc(total_ej))

```

```{r}
ggplot(energy_type_total, aes(x = reorder(Type, total_ej), y = total_ej, fill = Type)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(
    title = "Fig 3:Total Global Energy Consumption by Type (1965–2021)",
    x = "Energy Type",
    y = "Total Energy Consumption (EJ)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.y = element_text(face = "bold")
  )

```

**Figure 3** shows how different types of energy have contributed to global use between 1965 and 2021. Oil clearly leads overall, with coal and natural gas not far behind. Together, these fossil fuels make up most of the world’s energy supply. Hydro and nuclear have stayed fairly steady through the years, while newer renewables like wind, solar, and biofuels are still small but slowly growing.

Renewables were meant to be the safer alternative for a cleaner planet, yet the world still relies on fossil fuels as its main source of energy.

## 4. Differentiation between Renewable & Non-Renewable Energy

```{r}
renew_types <- c("Solar", "Wind", "Hydro-electric", "Biofuel", "Other renewables")

energy_region_share <- energy_clean %>%
  mutate(Category = ifelse(Type %in% renew_types, "Renewable", "Non-Renewable")) %>%
  group_by(Region, Year, Category) %>%
  summarise(total = sum(energy_ej, na.rm = TRUE), .groups = "drop") %>%
  group_by(Region, Year) %>%
  mutate(share = total / sum(total))

head(energy_region_share)
```

```{r}

ggplot(energy_region_share, aes(x = Year, y = share, fill = Category)) +
  geom_col(position = "fill") +
  facet_wrap(~ Region, nrow = 2) +
  scale_x_continuous(
    breaks = seq(1965, 2021, by = 15),
    expand = c(0, 0)
  ) +
  scale_y_continuous(
    labels = function(x) paste0(x * 100, "%") 
  ) +
  labs(
    title = "Fig 4:Renewable vs Non-Renewable Energy Share by Region (1965–2021)",
    x = "Year",
    y = "Share of Total Energy",
    fill = "Category"
  ) +
  theme_minimal() +
  theme(
    plot.title  = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    strip.text  = element_text(face = "bold")
  )

```

## 5. Energy Consumption Trends by Region

```{r}
energy_region <- energy_clean %>%
  group_by(Region, Year) %>%
  summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups = "drop")
```

```{r}

ggplot(energy_region, aes(x = Year, y = total_ej)) +
  geom_point(color = "black", size = 1) +        # black points
  geom_smooth(method = "loess", color = "blue", se = FALSE, size = 0.6) +  
  facet_wrap(~ Region, nrow = 2) +
  labs(
    title = "Fig 5:Energy Consumption Trends by Region (1965–2021)",
    x = "Year",
    y = "Energy Consumption (EJ)"
  ) +
  theme_minimal() +
  theme(
    plot.title  = element_text(face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    strip.text  = element_text(face = "bold")
  )

```

The Figure 5 shows how energy consumption has changed across world regions between 1965 and 2021.

-Asia Pacific has the fastest and biggest growth in energy use. -Europe and North America rose until about 2000 and then stayed mostly flat. -Middle East and Africa both increased slowly but steadily. -CIS fell in the early 1990s and then stayed about the same. -South and Central America shows a steady, gradual rise.

Overall, energy use has grown the most in developing regions, while older industrial areas have stopped increasing.

#VIZ-5

```{r}
energy_change <- energy_clean %>%
  group_by(Year) %>%
  summarize(total_ej = sum(energy_ej, na.rm = TRUE), .groups="drop") %>%
  arrange(Year) %>%
  mutate(pct_change = (total_ej - lag(total_ej)) / lag(total_ej) * 100)
```

```{r}
ggplot(energy_change, aes(x = Year, y = pct_change)) +
  geom_col(fill = "steelblue") +
  geom_hline(yintercept = 0, color="gray40") +
  labs(title = "Fig 6:Year-to-Year % Change in Global Energy Consumption",
       x = "Year", y = "Percent Change") +
  theme_minimal() +
  theme(plot.title = element_text(face="bold", hjust=0.5))

```

The figure 6 shows Growth was very strong in the 1970s, often above 5 percent per year. It slowed in the early 1980s and even turned negative during global recessions. From the 1990s through the 2010s, the rate of increase stayed positive but more moderate, usually between 1 and 4 percent. A sharp fall appears around 2020, reflecting the global slowdown during the COVID-19 pandemic, followed by a quick rebound the next year. Overall, energy use keeps rising over time, but the speed of growth has become less steady, with slowdowns during major economic disruptions.
